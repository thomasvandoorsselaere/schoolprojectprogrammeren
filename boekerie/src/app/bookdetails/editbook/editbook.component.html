<h1>Editeer Boek</h1>

<hr>
<div class="col-md-6">
  <form #editBookForm="ngForm" (ngSubmit)="updateBoek()" autocomplete="off" novaliauthor>

    <div class="form-group" [ngClass]="{'error': editBookForm.controls.name?.invalid && editBookForm.controls.name?.touched}">
      <label for="bookTitle">Titel:</label>
        <em *ngIf="editBookForm.controls.name?.invalid && (editBookForm.controls.name?.touched)">Required</em>
          <input [(ngModel)]="book.titel" name="name" required id="name" type="text" class="form-control" value="" placeholder="{{book.titel}}" />
    </div>

    <div class="form-group" [ngClass]="{'error': editBookForm.controls.author?.invalid && editBookForm.controls.author?.touched}">
        <label for="bookAuthor">Auteur:</label>
         <input [(ngModel)]="book.auteur.naam" name="auteur" required id="auteur" type="text" class="form-control" value="{{book.auteur.naam}}" placeholder="{{book.auteur.naam}}" />
            <!--<select class="btn btn-default dropdown-toggle form-control" aria-haspopup="true" aria-expanded="true" [(ngModel)]="selectedAuteur">
              <option value="undefined">Selecteer auteur</option>
              <option *ngFor="let auteur of auteurs" [ngValue]="auteur">{{auteur.naam}}</option>
            </select>-->
    </div>

    <div class="form-group" [ngClass]="{'error': editBookForm.controls.isbn?.invalid && editBookForm.controls.isbn?.touched}">
      <label for="bookIsbn">ISBN:</label>
        <em *ngIf="editBookForm.controls.isbn?.invalid && (editBookForm.controls.isbn?.touched)">Required</em>
          <input [(ngModel)]="book.isbn" name="isbn" required id="bookIsbn" type="text" class="form-control" placeholder=" {{book.isbn}}" value="{{book.isbn}}" />
    </div>

    <div class="form-group" [ngClass]="{'error': editBookForm.controls.genre?.invalid && editBookForm.controls.genre?.touched}">
      <label for="bookgenre">Genre:</label>
       <input [(ngModel)]="book.genre.naam" name="genre" required id="genre" type="text" class="form-control" placeholder=" {{book.genre.naam}}" />
        <!--<select class="btn btn-default dropdown-toggle form-control" aria-haspopup="true" aria-expanded="true" [(ngModel)]="selectedGenre">
           <option value="undefined">Selecteer genre</option>
           <option *ngFor="let genre of genres" [ngValue]="genre">{{genre.naam}}</option>
        </select>-->
    </div>
    <!--Tags moten sowieso herbekeken worden cfr. create-book -->
<!--     <div class="form-group" [ngClass]="{'error': editBookForm.controls.tags?.invalid && editBookForm.controls.tags?.touched}">
      <label for="bookTags">Tags:</label>
        <em *ngIf="editBookForm.controls.tags?.invalid && (editBookForm.controls.tags?.touched)">Required</em>
          <input (ngModel)="tags" name="tags" required id="bookTags" type="text" class="form-control" placeholder="{{book.tags}}" />
    </div>-->
    <div class="form-group">
      <label>Tags:</label>
      <div class="col-md-12">
        <span *ngFor="let tag of selectedTags" name="deleteTagButton" class="badge selectedTag" (click)="removeTagFromSelected(tag)">
          <span aria-hidden="true" class="glyphicon glyphicon-tag"></span>
          &nbsp;{{ tag | uppercase }}&nbsp;
          <span aria-hidden="true" class="glyphicon glyphicon-remove-sign"></span>
        </span>
        <span *ngFor="let tag of availableTags" name="deleteTagButton" class="badge availableTag" (click)="addTagToSelected(tag)">
          <span aria-hidden="true" class="glyphicon glyphicon-tag"></span>
          &nbsp;{{ tag }}&nbsp;
        </span>
      </div>
      <div class="col-md-12"><hr></div>
      <input [(ngModel)]="newTagModel" #newTag name="newTagInput" type="text" class="form-control" placeholder="Voeg een nieuwe tag toe..." />
      <button  class="btn btn-success" type="button" (click)="addNewTag(newTag.value)"><i class="glyphicon glyphicon-ok"></i></button>

     </div>
    <div class="form-group">
      <label for="uitgegeven">Uitgegeven:</label>
        <input [(ngModel)]="book.uitgegeven" type="text" class="form-control" name="uitgegeven" type="number" placeholder="{{book.uitgegeven}}" />
    </div>
    
    <div class="form-group" [ngClass]="{'error': editBookForm.controls.imageUrl?.invalid && editBookForm.controls.imageUrl?.touched}">
      <label for="imageUrl">Cover:</label>
        <em *ngIf="editBookForm.controls.imageUrl?.invalid && editBookForm.controls.imageUrl?.touched && editBookForm.controls.imageUrl?.errors.required">Required</em>
        <em *ngIf="editBookForm.controls.imageUrl?.invalid && editBookForm.controls.imageUrl?.touched  && editBookForm.controls.imageUrl?.errors.pattern">Must be a png or jpg url</em>
          <input [(ngModel)]="book.cover.value" name="imageUrl" required pattern=".*\/.*.(png|jpg)" id="imageUrl" type="text" class="form-control" placeholder="{{book.cover}}"/>
            <img [src]="editBookForm.controls.imageUrl.value" *ngIf="editBookForm.controls.imageUrl?.valid"/>
    </div>
    
    <button type="submit" class="btn btn-primary" >Save</button>
    <button type="button" [disabled]="editBookForm.invalid" class="btn btn-default" (click)="cancel()" [routerLink]="['/details', book.isbn]">Cancel</button>
  </form>
</div>